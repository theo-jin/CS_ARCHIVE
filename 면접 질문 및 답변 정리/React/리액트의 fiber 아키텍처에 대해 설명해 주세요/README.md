# 리액트의 fiber 아키텍처에 대해 설명해 주세요

Fiber는 React v16에서 리액트의 핵심 알고리즘을 재구성한 새 재조정(Reconciliation) 엔진  

Fiber 아키텍처는 React의 렌더링 프로세스를 더 세분화하고 우선순위를 관리하여 더 나은 사용자 경험을 제공하고자 하는 목적

React Fiber의 핵심 기능은 렌더링 작업을 여러 덩어리로 나누어 여러 프레임에 분산하고 다양한 유형의 업데이트에 우선 순위를 지정하는 것
 
### 기능의 주요 목표
1. 중단 가능한 작업을 덩어리로 나누기
2. 진행 중인 작업의 우선순위를 지정하고, 리베이스하고 재사용
3. 리액트의 레이아웃을 지원하기 위해 부모와 자식 간에 yield back and forth
4. render()로부터 다수 엘리먼트들을 반환
5. 에러 바운더리에 대한 더 나은 지원

Reconciliation
React가 변경해야 할 부분을 결정하기 위해 한 트리를 다른 트리와 비교하는 데 사용하는 알고리즘

Fiber는 Reconciler를 재구현한다.

## Fiber
Fiber는 React에서 렌더링 작업을 수행하는 가상의 "섬"이라고 생각할 수 있습니다. 이것은 React 업데이트를 나타내는 단위이며, 여러 Fiber가 하나의 컴포넌트 트리를 구성

1. 비동기 및 중단 가능한 렌더링:

Fiber 아키텍처는 렌더링 작업을 작은 단위로 나누어 우선순위를 부여하고, 브라우저가 유저 인터랙션에 응답하기 위해 작업을 중단하고 다른 작업을 처리할 수 있게 합니다. 이를 통해 더 부드러운 사용자 경험을 제공할 수 있습니다.

2. 작업 우선순위:

Fiber 아키텍처는 각각의 Fiber에 우선순위를 부여하여 어떤 작업이 먼저 처리되어야 하는지 결정합니다. 이를 통해 사용자에게 더 빠르게 응답하고, 인터랙션에 우선순위를 부여할 수 있습니다.  

3. Render와 Commit 단계:

렌더링 작업은 두 단계로 나뉩니다. 먼저 "Render" 단계에서는 Fiber 트리를 업데이트하고, 그 다음 "Commit" 단계에서는 변경 사항을 실제 DOM에 반영합니다. 이러한 분리는 중단 가능한(concurrent) 렌더링을 가능케 합니다.  

4. Reconciliation 알고리즘:

Fiber는 이전과 같이 가상 DOM을 사용하여 변경 사항을 찾아내고 실제 DOM에 적용하는 Reconciliation 알고리즘을 사용합니다. 그러나 Fiber는 렌더링 작업을 일시 중단하고 우선순위를 조절하는 등의 기능을 지원하여 성능을 최적화합니다.

 Fiber의 목표는 리액트가 스케줄링의 이점을 활용할 수 있도록 하는 것
그러기 위해서
- 일을 잠시 멈추고 나중에 다시 돌아오기
- 다른 유형의 일에 우선권 부여하기
- 이전에 완성한 작업을 재상용하기
- 더 이상 필요하지 않은 작업을 중단하기

이들을 하기 위해선, 먼저 단위별로 세분화해야 하며, 이 과정 자체가 Fiber라고 할 수 있다. Fiber는 작업의 한 단위(unit of work)를 나타낸다.

Fiber는 리액트 컴포넌트에 특화된 stack의 재구성이다. 

하나의 Fiber를 virtaul stack frame으로 간주할 수 있다.

stack을 재구성함으로써 얻는 이점은 stack frame을 메모리에 보관하고 원하는 경우 언제든지 실행할 수 있다는 것이다. 그래서 스케줄링 목표를 달성하는 데 매우 중요하다.

stack frame을 수동으로 처리하면 스케줄링뿐만 아니라 concurrency 및 error boundary와 같은 기능들에 대한 잠재력을 확보할 수 있다.

## Reference
https://velog.io/@jangws/React-Fiber