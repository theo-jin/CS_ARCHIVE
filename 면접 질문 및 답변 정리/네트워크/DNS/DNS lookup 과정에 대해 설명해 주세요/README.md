# DNS(Domain Name Syetem)란?
- 도메인 이름과 ip주소를 매핑해주는 서버, DNS과정 덕분에 ip주소가 바뀌어도 사용자들에게 똑같은 도메인 주소로 서비스 가능. 
- 웹사이트에 접속 할 때 우리는 외우기 어려운 IP 주소 대신 도메인 이름을 사용한다.
- 도메인 이름을 사용했을 때 입력한 도메인을 실제 네트워크상에서 사용하는 IP 주소로 바꾸고 해당 IP 주소로 접속하는 과정이 필요하다.
- 이러한 과정, 전체 시스템을 DNS(도메인 네임 시스템)라고 한다.
- 이러한 시스템은 전세계적으로 약속된 규칙을 공유한다.
- 상위 기관에서 인증된 기관에게 도메인을 생성하거나 IP 주소로 변경할 수 있는 ‘권한’을 부여한다.
- DNS는 이처럼 상위 기관과 하위 기관과 같은 ‘계층 구조’를 가지는 분산 데이터베이스 구조를 가진다.         

## ❗️DNS 구성 요소
DNS는 아래 세가지 요소로 구성되어있다.
```
- 도메인 네임 스페이스(Domain Name Space)
- 네임 서버(Name Server) = 권한 있는 DNS 서버
- 리졸버(Resolver) = 권한 없는 DNS 서버
```
- 도메인 네임 스페이스라는 규칙(방법)으로 도메인 이름 저장을 분산한다.
- 네임 서버(DNS 서버와 같은 말, 그런데 리졸버 서버 등 시스템 안에서 다른 역할을 하는 서버도 있기에 그냥 DNS 서버라고 하는 것보다 네임 서버라고 하는게 더 의미가 전달되는 듯)가 해당 도메인 이름의 IP 주소를 찾는다.
- 리졸버가 DNS 클라이언트 요청을 네임 서버로 전달하고 찾은 정보를 클라이언트에게 제공하는 기능을 수행한다.
어떤 네임 서버에서 찾아야하는지, 이미 캐시 되어있는지 등 어떻게든 찾아서 클라이언트에게 찾았으면 찾은 것을 못 찾았으면 못 찾았다고 전달하는 역할을 한다.
- 리졸버는 단말에 구현하는 것은 무리수라 보통은 리졸버가 구현된 네임 서버의 IP 주소만을 파악한다.
대표적인 것이 KT/LG/SK와 같은 ISP(통신사) DNS 있고, 브라우저 우회 용도로 많이 쓰는 구글 DNS, 클라우드플레어와 같은 Public DNS 서버가 있다.
그래서 거의 Resolver = Recursive DNS Server = Local Server(of ISP) = Recursor

💡 도메인은 domain name 과 subdomain, TLD로 구성된 host 를 의미한다.
www (subdomain) + google (domain name) + com (TLD) = www.google.com

📍 TLD 는 일반적으로 6가지 종류로 분류될 수 있다. 

Generic(gTLD) : 일반적인 TLD (ex  .com, .edu, .gov), 3글자 이상으로 구성
country-code(ccTLD) : 두 글자의 국가 코드 사용 (ex  .kr)
sponsored(sTLD) : 전문가 집단, 위치 등 특정 목적을 위한 스폰서를 둠 (ex  .asia, .edu)
infrastructure : 중요한 인프라 식별자 공간 지원을 위한 전용 도메인 (ex  .arpa)
generic-restricted(grTLD) : 특정 기준을 충족하는 사람이나 단체 사용 가능 (ex  .biz, .name)
test(tTLD) : 개발 프로세스에서 테스트 목적으로 사용 (ex  .test)

## DNS lookup은 DNS동작 방식
1. 웹 브라우저 창에 도메인 주소 입력 -> 로컬 컴퓨터의 캐시에 해당 도메인의 IP 가 저장되어 있는지 확인 

1-1. 있는 경우 바로 해당 IP 주소로 패킷 전송, 없는 경우 로컬 DNS 서버로 쿼리를 보낸다.

2. DNS 서버의 캐시 및 주소록에서 IP 주소 검색

2-1. 있는 경우 바로 해당 IP 주소로 패킷 전송, 없는 경우 연결된 Root DNS 서버로 쿼리를 보낸다.

3. Root DNS 서버 (최상위 도메인에 대한 권한이 있는 네임 서버 목록을 반환하는 도메인 네임 서버이며, 전 세계에 13대밖에 없다.) 에서 도메인의 TLD 정보를 가지고 있는 하위 DNS 서버 IP 요청 (".com" )

4. 하위 DNS 서버에서 다음 계층의 주소를 포함하는 도메인 주소의 정보를 가지고 있는 하위 DNS 서버 IP 요청 ("google.com")

5. 같은 방식으로 계층 하나씩 이동하며 최종 domain 의 IP 주소를 받을 때까지 쿼리 반복 

6. 마지막으로 IP 주소를 로컬 DNS 와 브라우저 PC 에 캐싱한 뒤 패킷 전송 

💡 클라이언트에서 로컬 DNS 서버로 보내는 요청을 재귀적 (recursive) 쿼리 라고 한다. 
💡 로컬 DNS 에서 root DNS 서버 & 하위 DNS 서버에 보내는 요청을 반복적 (iterative) 쿼리 라고 한다. 